import yaml
import os
import sys

from ripe.atlas.tools.commands.measure import TracerouteMeasureCommand as trace

try:
    with open(os.path.expanduser("~") + "/.config/ripe-atlas-tools/config.yml", "r") as ymlfile:
        cfg = yaml.load(ymlfile)
except IOError:
    cfg = {'traceroute': {'response-timeout': 50, 'packets': 1, 'probes': 2}}

args = ["traceroute", "--traceroute-show-asns", "--resolve-on-probe"]
print(cfg)
for arg in cfg["traceroute"]:
    print(arg)
    args.append("--" + str(arg))
    args.append(str(cfg["traceroute"][arg]))
args.append("--target")
args.append(str(sys.argv[1]))
print(args)

cmd = trace()
cmd.init_args(args)
cmd.run()
